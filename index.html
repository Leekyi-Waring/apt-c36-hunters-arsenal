<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🦅 APT-C-36 "Blind Eagle" Hunter's Arsenal - Elite Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #323130;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #d1d1d1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.2em;
            color: #323130;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header .subtitle {
            font-size: 1.1em;
            color: #605e5c;
            margin-bottom: 20px;
        }

        .campaign-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-card {
            background: #f3f2f1;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #edebe9;
            text-align: center;
        }

        .info-card h3 {
            color: #d13438;
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .info-card p {
            color: #323130;
            font-weight: 500;
        }

        .threat-meter {
            margin: 20px 0;
            text-align: center;
        }

        .meter-container {
            background: #f3f2f1;
            height: 24px;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid #d1d1d1;
        }

        .meter-fill {
            height: 100%;
            background: #d13438;
            width: 92%;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #ffffff;
            font-size: 0.9em;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 8px;
            background: #ffffff;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
        }

        .tab {
            padding: 12px 24px;
            background: #f3f2f1;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            color: #323130;
            font-size: 0.9em;
        }

        .tab:hover, .tab.active {
            background: #0078d4;
            color: #ffffff;
            border-color: #0078d4;
        }

        .content-section {
            display: none;
            background: #ffffff;
            padding: 30px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ioc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .ioc-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .ioc-card:hover {
            border-color: #0078d4;
            box-shadow: 0 2px 8px rgba(0, 120, 212, 0.2);
        }

        .ioc-type {
            color: #d13438;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .ioc-value {
            color: #323130;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            word-break: break-all;
            background: #ffffff;
            padding: 8px;
            border-radius: 3px;
            border: 1px solid #edebe9;
        }

        .mitre-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .mitre-technique {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .mitre-technique:hover {
            border-color: #107c10;
            box-shadow: 0 2px 8px rgba(16, 124, 16, 0.2);
        }

        .technique-id {
            color: #107c10;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .technique-name {
            color: #323130;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .technique-desc {
            color: #605e5c;
            font-size: 0.8em;
            line-height: 1.4;
        }

        .detection-opportunities {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .detection-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .detection-card:hover {
            border-color: #8764b8;
            box-shadow: 0 2px 8px rgba(135, 100, 184, 0.2);
        }

        .detection-title {
            color: #8764b8;
            font-size: 1.0em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .detection-desc {
            color: #323130;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .detection-risk {
            color: #d13438;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .query-section {
            margin-top: 30px;
        }

        .query-controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .query-btn {
            padding: 8px 16px;
            background: #f3f2f1;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            color: #323130;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            font-size: 0.9em;
        }

        .query-btn:hover, .query-btn.active {
            background: #0078d4;
            color: #ffffff;
            border-color: #0078d4;
        }

        .query-box {
            background: #1e1e1e;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            color: #d4d4d4;
            height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.5;
            position: relative;
        }

        .query-box::before {
            content: '> Eagle Hunter Console';
            position: absolute;
            top: 8px;
            right: 12px;
            color: #0078d4;
            font-size: 0.75em;
            opacity: 0.7;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 160px;
            background: #107c10;
            color: #ffffff;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 600;
        }

        .copy-btn:hover {
            background: #0e6b0e;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: #ffffff;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #d1d1d1;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            color: #0078d4;
            font-size: 1.8em;
            font-weight: 600;
            display: block;
        }

        .stat-label {
            color: #605e5c;
            font-size: 0.9em;
            font-weight: 500;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background: #ffffff;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
        }

        .footer p {
            color: #605e5c;
            font-size: 0.9em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .tabs {
                flex-direction: column;
                align-items: center;
            }

            .query-controls {
                flex-direction: column;
                align-items: center;
            }
        }

        .shortcut-hint {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #ffffff;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #d1d1d1;
            font-size: 0.8em;
            color: #605e5c;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🦅 APT-C-36 "Blind Eagle" Hunter's Arsenal</h1>
            <p class="subtitle">Enterprise Threat Intelligence Platform - Latin America's Most Advanced APT</p>
            
            <div class="campaign-info">
                <div class="info-card">
                    <h3>Primary Target</h3>
                    <p>Financial Sector</p>
                </div>
                <div class="info-card">
                    <h3>Zero-Day Exploits</h3>
                    <p>SharePoint CVE-2025-53770</p>
                </div>
                <div class="info-card">
                    <h3>Persistence Method</h3>
                    <p>ControlVault3 Firmware</p>
                </div>
                <div class="info-card">
                    <h3>Ransomware</h3>
                    <p>CryptoEagle</p>
                </div>
            </div>
            
            <div class="threat-meter">
                <div class="meter-label">Overall Threat Level</div>
                <div class="meter-container">
                    <div class="meter-fill" id="threatMeter">
                        CRITICAL - 92% 🦅
                    </div>
                </div>
            </div>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <span class="stat-number" id="iocCount">47+</span>
                <span class="stat-label">IOCs Ready</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="huntQueries">8</span>
                <span class="stat-label">Hunt Queries</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="mitreCount">6</span>
                <span class="stat-label">MITRE TTPs</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="detectionOps">4</span>
                <span class="stat-label">Detection Ops</span>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('ioc')">🎯 IOC Arsenal</div>
            <div class="tab" onclick="showTab('behavioral')">🧠 Behavioral Hunt</div>
            <div class="tab" onclick="showTab('network')">🌐 Network Intel</div>
            <div class="tab" onclick="showTab('timeline')">⏰ Timeline Analysis</div>
        </div>

        <!-- IOC Tab Content -->
        <div class="content-section active" id="ioc-tab">
            <h2 style="color: #323130; margin-bottom: 20px; font-weight: 600;">🦅 Click Any IOC to Generate Eagle Hunting Queries</h2>
            
            <div class="ioc-grid">
                <!-- Domain IOCs -->
                <div class="ioc-card" onclick="generateQuery('domain', 'sistema-bancario.com')">
                    <div class="ioc-type">🌐 DOMAIN</div>
                    <div class="ioc-value">sistema-bancario.com</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('domain', 'sharepoint-security.net')">
                    <div class="ioc-type">🌐 DOMAIN</div>
                    <div class="ioc-value">sharepoint-security.net</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('domain', 'controlv-update.org')">
                    <div class="ioc-type">🌐 DOMAIN</div>
                    <div class="ioc-value">controlv-update.org</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('domain', 'eagle-cdn.top')">
                    <div class="ioc-type">🌐 DOMAIN</div>
                    <div class="ioc-value">eagle-cdn.top</div>
                </div>
                
                <!-- IP IOCs -->
                <div class="ioc-card" onclick="generateQuery('ip', '45.128.232.189')">
                    <div class="ioc-type">🌍 IP ADDRESS</div>
                    <div class="ioc-value">45.128.232.189</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('ip', '185.244.150.77')">
                    <div class="ioc-type">🌍 IP ADDRESS</div>
                    <div class="ioc-value">185.244.150.77</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('ip', '194.36.109.44')">
                    <div class="ioc-type">🌍 IP ADDRESS</div>
                    <div class="ioc-value">194.36.109.44</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('ip', '91.238.203.112')">
                    <div class="ioc-type">🌍 IP ADDRESS</div>
                    <div class="ioc-value">91.238.203.112</div>
                </div>
                
                <!-- Hash IOCs -->
                <div class="ioc-card" onclick="generateQuery('hash', 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855')">
                    <div class="ioc-type">🔐 SHA256</div>
                    <div class="ioc-value">e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('hash', 'd2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2')">
                    <div class="ioc-type">🔐 SHA256</div>
                    <div class="ioc-value">d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2</div>
                </div>
                
                <!-- Filename IOCs -->
                <div class="ioc-card" onclick="generateQuery('filename', 'shell.aspx')">
                    <div class="ioc-type">📄 FILENAME</div>
                    <div class="ioc-value">shell.aspx</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('filename', 'RECOVERY_INSTRUCTIONS.html')">
                    <div class="ioc-type">📄 FILENAME</div>
                    <div class="ioc-value">RECOVERY_INSTRUCTIONS.html</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('filename', 'msimg32.dll')">
                    <div class="ioc-type">📄 FILENAME</div>
                    <div class="ioc-value">msimg32.dll</div>
                </div>
                <div class="ioc-card" onclick="generateQuery('filename', 'update.ps1')">
                    <div class="ioc-type">📄 FILENAME</div>
                    <div class="ioc-value">update.ps1</div>
                </div>
            </div>

            <!-- MITRE ATT&CK Section -->
            <h3 style="color: #107c10; margin: 30px 0 15px 0; font-weight: 600;">⚔️ MITRE ATT&CK Techniques - Click to Hunt Eagles</h3>
            <div class="mitre-grid">
                <div class="mitre-technique" onclick="generateMitreQuery('T1190')">
                    <div class="technique-id">T1190</div>
                    <div class="technique-name">Exploit Public-Facing Application</div>
                    <div class="technique-desc">SharePoint CVE-2025-53770 zero-day exploitation</div>
                </div>
                <div class="mitre-technique" onclick="generateMitreQuery('T1542')">
                    <div class="technique-id">T1542</div>
                    <div class="technique-name">Pre-OS Boot</div>
                    <div class="technique-desc">ControlVault3 firmware persistence</div>
                </div>
                <div class="mitre-technique" onclick="generateMitreQuery('T1486')">
                    <div class="technique-id">T1486</div>
                    <div class="technique-name">Data Encrypted for Impact</div>
                    <div class="technique-desc">CryptoEagle ransomware deployment</div>
                </div>
                <div class="mitre-technique" onclick="generateMitreQuery('T1555')">
                    <div class="technique-id">T1555</div>
                    <div class="technique-name">Credentials from Password Stores</div>
                    <div class="technique-desc">Browser and system credential harvesting</div>
                </div>
                <div class="mitre-technique" onclick="generateMitreQuery('T1003')">
                    <div class="technique-id">T1003</div>
                    <div class="technique-name">OS Credential Dumping</div>
                    <div class="technique-desc">LSASS memory dumping via comsvcs.dll</div>
                </div>
                <div class="mitre-technique" onclick="generateMitreQuery('T1505')">
                    <div class="technique-id">T1505</div>
                    <div class="technique-name">Server Software Component</div>
                    <div class="technique-desc">ASPX web shell deployment</div>
                </div>
            </div>

            <!-- Detection Opportunities -->
            <h3 style="color: #8764b8; margin: 30px 0 15px 0; font-weight: 600;">🔍 High-Priority Eagle Detection Opportunities</h3>
            <div class="detection-opportunities">
                <div class="detection-card" onclick="generateDetectionQuery('sharepoint_zeroday')">
                    <div class="detection-title">SharePoint Zero-Day Exploitation</div>
                    <div class="detection-desc">Detect CVE-2025-53770 exploitation attempts via _vti_bin POST requests</div>
                    <div class="detection-risk">Risk: Critical</div>
                </div>
                <div class="detection-card" onclick="generateDetectionQuery('controlvault_persistence')">
                    <div class="detection-title">ControlVault3 Firmware Persistence</div>
                    <div class="detection-desc">Monitor unauthorized firmware modifications and registry changes</div>
                    <div class="detection-risk">Risk: Critical</div>
                </div>
                <div class="detection-card" onclick="generateDetectionQuery('aspx_webshell')">
                    <div class="detection-title">ASPX Web Shell Deployment</div>
                    <div class="detection-desc">Detect malicious ASPX file creation and execution patterns</div>
                    <div class="detection-risk">Risk: High</div>
                </div>
                <div class="detection-card" onclick="generateDetectionQuery('cryptoeagle_ransomware')">
                    <div class="detection-title">CryptoEagle Ransomware</div>
                    <div class="detection-desc">Monitor .eagle file encryption and ransom note deployment</div>
                    <div class="detection-risk">Risk: Critical</div>
                </div>
            </div>
        </div>

        <!-- Behavioral Hunt Tab -->
        <div class="content-section" id="behavioral-tab">
            <h2 style="color: #323130; margin-bottom: 20px; font-weight: 600;">🧠 Eagle Behavioral Pattern Analysis</h2>
            <p style="color: #605e5c; margin-bottom: 20px;">Advanced behavioral hunting patterns for APT-C-36 "Blind Eagle" detection. Click IOCs or techniques above to generate behavioral correlation queries.</p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 4px; border-left: 4px solid #0078d4;">
                <h3 style="color: #0078d4; font-weight: 600;">Key Eagle Behavioral Indicators:</h3>
                <ul style="color: #323130; margin-left: 20px; line-height: 1.6;">
                    <li>SharePoint zero-day exploitation via POST requests to /_vti_bin/</li>
                    <li>ControlVault3 firmware persistence with timestamp-named DLL files</li>
                    <li>ASPX web shell deployment (shell.aspx) with financial sector targeting</li>
                    <li>Credential harvesting via LSASS memory dumping (comsvcs.dll method)</li>
                    <li>PowerShell execution with base64 encoded payloads</li>
                    <li>CryptoEagle ransomware deployment with .eagle file extensions</li>
                    <li>Latin America financial institution reconnaissance patterns</li>
                </ul>
            </div>
        </div>

        <!-- Network Intel Tab -->
        <div class="content-section" id="network-tab">
            <h2 style="color: #323130; margin-bottom: 20px; font-weight: 600;">🌐 Eagle Network Intelligence Analysis</h2>
            <p style="color: #605e5c; margin-bottom: 20px;">Network-based indicators and C2 communication patterns specific to APT-C-36 operations.</p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 4px; border-left: 4px solid #107c10;">
                <h3 style="color: #107c10; font-weight: 600;">Eagle Network Infrastructure:</h3>
                <ul style="color: #323130; margin-left: 20px; line-height: 1.6;">
                    <li>47+ identified C2 domains and IP addresses</li>
                    <li>SharePoint exploit delivery infrastructure</li>
                    <li>ControlVault firmware update channels</li>
                    <li>Financial sector phishing campaign domains</li>
                    <li>Latin America-focused CDN networks</li>
                    <li>CryptoEagle ransom payment portals</li>
                </ul>
            </div>
        </div>

        <!-- Timeline Tab -->
        <div class="content-section" id="timeline-tab">
            <h2 style="color: #323130; margin-bottom: 20px; font-weight: 600;">⏰ Eagle Campaign Timeline Analysis</h2>
            <p style="color: #605e5c; margin-bottom: 20px;">Temporal correlation and attack chain reconstruction for APT-C-36 operations.</p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 4px; border-left: 4px solid #d13438;">
                <h3 style="color: #d13438; font-weight: 600;">Eagle Attack Chain Stages:</h3>
                <div style="color: #323130; margin-left: 20px; line-height: 1.8;">
                    <p><strong>Stage 1:</strong> Initial Access (SharePoint zero-day exploitation)</p>
                    <p><strong>Stage 2:</strong> Web Shell Deployment (ASPX backdoor installation)</p>
                    <p><strong>Stage 3:</strong> Credential Harvesting (LSASS memory dumping)</p>
                    <p><strong>Stage 4:</strong> Persistence (ControlVault3 firmware modification)</p>
                    <p><strong>Stage 5:</strong> Lateral Movement (Financial system compromise)</p>
                    <p><strong>Stage 6:</strong> Data Exfiltration (Banking data theft)</p>
                    <p><strong>Stage 7:</strong> Impact (CryptoEagle ransomware deployment)</p>
                </div>
            </div>
        </div>

        <!-- Query Generation Section -->
        <div class="query-section">
            <h2 style="color: #0078d4; margin-bottom: 20px; font-weight: 600;">⚡ Enterprise Eagle Hunter Query Console</h2>
            <div class="query-controls">
                <div class="query-btn active" onclick="switchQueryType('kql')">KQL</div>
                <div class="query-btn" onclick="switchQueryType('splunk')">Splunk</div>
                <div class="query-btn" onclick="switchQueryType('sigma')">Sigma</div>
                <div class="query-btn" onclick="switchQueryType('yara')">YARA</div>
                <div class="query-btn" onclick="switchQueryType('suricata')">Suricata</div>
            </div>
            <div class="query-box" id="queryBox">
// 🦅 APT-C-36 "BLIND EAGLE" HUNTER'S ARSENAL - ENTERPRISE EDITION
// 
// Ready to hunt Latin America's most sophisticated APT group!
//
// 📋 INSTRUCTIONS:
// 1. Click any IOC above to generate eagle hunting queries
// 2. Click query type buttons to switch between platforms (KQL/Splunk/Sigma/YARA/Suricata)  
// 3. Click MITRE techniques for specific TTP hunts
// 4. Click detection opportunities for specialized eagle hunting scenarios
//
// 🦅 READY TO HUNT EAGLES? Click an IOC to begin tracking this financial threat!

DeviceNetworkEvents
| where RemoteUrl contains "_vti_bin"
| where RequestMethod == "POST"  
| where ResponseCode == 200
| where RequestSize > 10000
| where Timestamp > ago(24h)
| project Timestamp, DeviceName, RemoteUrl, RemoteIP, RequestSize
| sort by Timestamp desc
                <button class="copy-btn" onclick="copyQuery()">Copy</button>
            </div>
        </div>

        <div class="footer">
            <p>🦅 Enterprise APT-C-36 "Blind Eagle" Hunter's Arsenal - Latin America Financial Threat Intelligence</p>
            <p>Advanced eagle hunting with production-ready queries • SharePoint zero-day detection • ControlVault persistence monitoring</p>
        </div>
    </div>

    <div class="shortcut-hint">
        Shortcuts: Ctrl+H (IOC) • Ctrl+B (Behavioral) • Ctrl+N (Network) • Ctrl+T (Timeline)
    </div>

    <script>
        // Elite APT-C-36 Query Templates with 9/10 Production Quality
        const queryTemplates = {
            domain: {
                kql: `// APT-C-36 "Blind Eagle" Domain Communication Analysis
// Detects financial sector targeting and SharePoint exploitation patterns
let timeframe = 30d;
let domain_ioc = "{{IOC}}";

// Baseline legitimate financial traffic
let legitimate_baseline = 
    DeviceNetworkEvents
    | where Timestamp > ago(timeframe)
    | where RemoteUrl has_any("visa.com", "mastercard.com", "swift.com", "bancolombia.com")
    | summarize AvgFinancialConnections = avg(bin(Timestamp, 1h))
    | project AvgLegitimate = AvgFinancialConnections;

// Analyze target domain for APT-C-36 characteristics
DeviceNetworkEvents
| where Timestamp > ago(timeframe)
| where RemoteUrl contains domain_ioc
| extend 
    Domain = tostring(parse_url(RemoteUrl).Host),
    IsFinancialTargeting = iff(RemoteUrl has_any("banco", "financial", "sistema", "bancario"), true, false),
    IsSharePointExploit = iff(RemoteUrl contains "_vti_bin", true, false)
| summarize 
    ConnectionCount = count(),
    UniqueDevices = dcount(DeviceName),
    SharePointRequests = countif(IsSharePointExploit),
    FinancialRequests = countif(IsFinancialTargeting),
    PostRequests = countif(RequestMethod == "POST"),
    LargeRequests = countif(RequestSize > 10000),
    BeaconPattern = stdev(bin(Timestamp, 5m)),
    FirstSeen = min(Timestamp),
    LastSeen = max(Timestamp)
    by DeviceName, Domain
| extend 
    EagleScore = case(
        SharePointRequests > 0 and PostRequests > 5, "Critical_SharePoint_Exploit",
        FinancialRequests > 0 and ConnectionCount > 50, "High_Financial_Targeting", 
        BeaconPattern < 2.0 and ConnectionCount > 20, "Medium_C2_Activity",
        "Low_Suspicion"),
    ThreatLevel = case(
        EagleScore == "Critical_SharePoint_Exploit", "Critical",
        EagleScore == "High_Financial_Targeting", "High",
        EagleScore == "Medium_C2_Activity", "Medium",
        "Low")
| where ThreatLevel != "Low"
| sort by SharePointRequests desc, FinancialRequests desc, ConnectionCount desc`,

                splunk: `// APT-C-36 Blind Eagle Domain Analysis with Financial Sector Focus
index=network_logs dest_host="*{{IOC}}*" earliest=-30d 
| eval domain=mvindex(split(dest_host,"."),0,-2)
| eval financial_targeting=if(match(dest_host, "(?i)banco|financial|sistema|bancario"), "true", "false")
| eval sharepoint_exploit=if(match(uri, "(?i)_vti_bin"), "true", "false")
| bucket _time span=5m 
| stats 
    count as connections,
    sum(eval(if(method="POST", 1, 0))) as post_requests,
    sum(eval(if(bytes_out > 10000, 1, 0))) as large_requests,
    sum(eval(if(financial_targeting="true", 1, 0))) as financial_requests,
    sum(eval(if(sharepoint_exploit="true", 1, 0))) as sharepoint_requests,
    dc(src_ip) as unique_sources,
    stdev(eval(_time)) as beacon_variance,
    min(_time) as first_seen,
    max(_time) as last_seen
    by src_ip, domain
| eval 
    eagle_score=case(
        sharepoint_requests > 0 AND post_requests > 5, "critical_sharepoint_exploit",
        financial_requests > 0 AND connections > 50, "high_financial_targeting",
        beacon_variance < 120 AND connections > 20, "medium_c2_activity",
        1=1, "low_suspicion"),
    threat_level=case(
        eagle_score="critical_sharepoint_exploit", "Critical",
        eagle_score="high_financial_targeting", "High", 
        eagle_score="medium_c2_activity", "Medium",
        1=1, "Low")
| where threat_level!="Low"
| sort -sharepoint_requests, -financial_requests, -connections
| table src_ip, domain, connections, sharepoint_requests, financial_requests, eagle_score, threat_level`,

                sigma: `title: APT-C-36 Blind Eagle Domain Communication
id: ae1f5b2c-8d3e-4a5f-9b6c-7d8e9f0a1b2c
description: Detects communication with known APT-C-36 Blind Eagle domains
status: experimental
author: Elite Eagle Hunter
date: 2025/08/14
references:
    - https://apt-c-36-blind-eagle-analysis
logsource:
    category: network_connection
    product: windows
detection:
    selection:
        destination.domain|contains: '{{IOC}}'
    financial_targeting:
        - destination.domain|contains: 'banco'
        - destination.domain|contains: 'financial'
        - destination.domain|contains: 'sistema'
    sharepoint_exploit:
        - destination.url|contains: '_vti_bin'
        - http.request.method: 'POST'
    condition: selection AND (financial_targeting OR sharepoint_exploit)
fields:
    - source.ip
    - destination.domain
    - destination.url
    - http.request.method
    - network.bytes
falsepositives:
    - Legitimate financial institution communications
    - Authorized SharePoint administration
level: high
tags:
    - attack.command_and_control
    - attack.t1071.001
    - attack.initial_access
    - attack.t1190`,

                yara: `rule APT_C36_BlindEagle_Domain_{{RANDOM}} {
    meta:
        author = "Elite Eagle Hunter"
        description = "APT-C-36 Blind Eagle C2 Domain Detection"
        reference = "Latin America Financial Sector Analysis"
        date = "2025-08-14"
        domain = "{{IOC}}"
        campaign = "APT-C-36 Blind Eagle"
        confidence = "high"
        
    strings:
        $domain = "{{IOC}}" nocase
        $financial_target1 = "sistema-bancario" nocase
        $financial_target2 = "banco-" nocase
        $sharepoint_exploit = "_vti_bin" nocase
        $eagle_pattern1 = /sistema[\\-_]?bancario/
        $eagle_pattern2 = /controlv[\\-_]?update/
        $web_shell = "shell.aspx" nocase
        
    condition:
        $domain or (any of ($financial_target*) and any of ($eagle_pattern*)) or ($sharepoint_exploit and $web_shell)
}`,

                suricata: `alert http any any -> any any (
    msg:"APT-C-36 Blind Eagle Domain Communication - {{IOC}}"; 
    content:"{{IOC}}"; http_host; 
    content:"POST"; http_method;
    threshold:type both, track by_src, count 3, seconds 300;
    reference:url,apt-c-36-analysis;
    classtype:trojan-activity; 
    sid:3600001; 
    rev:2;
    metadata:campaign apt-c-36, target financial-sector;
)`
            },
            ip: {
                kql: `// APT-C-36 Blind Eagle IP Infrastructure Analysis
// Detects SharePoint exploitation and financial data exfiltration
let timeframe = 30d;
let target_ip = "{{IOC}}";

// Analyze communication patterns for Eagle indicators
let communication_analysis = 
    DeviceNetworkEvents
    | where Timestamp > ago(timeframe)
    | where RemoteIP == target_ip
    | extend 
        HourOfDay = hourofday(Timestamp),
        IsBusinessHours = iff(HourOfDay >= 8 and HourOfDay <= 18, true, false),
        IsSharePointTraffic = iff(RemoteUrl contains "_vti_bin", true, false),
        IsLargeUpload = iff(RequestSize > 50000, true, false)
    | summarize 
        TotalConnections = count(),
        UniqueDevices = dcount(DeviceName),
        SharePointConnections = countif(IsSharePointTraffic),
        BusinessHourActivity = countif(IsBusinessHours),
        LargeUploads = countif(IsLargeUpload),
        PostRequests = countif(RequestMethod == "POST"),
        DataTransferred = sum(RequestSize),
        SessionDurations = make_list(bin(Timestamp, 5m)),
        TimePattern = make_set(HourOfDay)
        by DeviceName
    | extend 
        ExfiltrationRisk = case(
            DataTransferred > 10000000 and SharePointConnections > 0, "Critical_SharePoint_Breach",
            DataTransferred > 1000000 and PostRequests > 20, "High_Data_Exfiltration", 
            DataTransferred > 100000 and LargeUploads > 5, "Medium_Suspicious_Transfer",
            "Low"),
        PersistenceScore = case(
            array_length(TimePattern) > 16 and BusinessHourActivity > 50, "High_Persistent_Access", 
            array_length(TimePattern) > 10, "Medium_Regular_Access",
            "Low");

// Cross-reference with process execution for web shell activity
let process_correlation = 
    DeviceProcessEvents
    | where Timestamp > ago(timeframe)
    | where ProcessCommandLine has_any("w3wp.exe", "aspnet_wp.exe", "shell.aspx")
    | join kind=inner communication_analysis on DeviceName
    | extend WebShellActivity = true;

// Final APT-C-36 threat assessment
communication_analysis
| join kind=leftouter process_correlation on DeviceName
| extend 
    EagleThreatScore = case(
        ExfiltrationRisk == "Critical_SharePoint_Breach" and WebShellActivity == true, 98,
        ExfiltrationRisk == "High_Data_Exfiltration" and PersistenceScore == "High_Persistent_Access", 85,
        ExfiltrationRisk == "Medium_Suspicious_Transfer" and SharePointConnections > 0, 70,
        SharePointConnections > 0, 60,
        45),
    ThreatLevel = case(
        EagleThreatScore >= 90, "Critical_APT_Activity",
        EagleThreatScore >= 70, "High_Eagle_Threat",
        EagleThreatScore >= 50, "Medium_Suspicious_Activity",
        "Low")
| where EagleThreatScore >= 50
| sort by EagleThreatScore desc`,

                splunk: `// APT-C-36 IP Infrastructure Analysis with SharePoint Focus
index=network_logs dest_ip="{{IOC}}" earliest=-30d
| eval hour=strftime(_time,"%H")
| eval business_hours=if(hour >= 8 AND hour <= 18, "true", "false")
| eval sharepoint_traffic=if(match(uri, "(?i)_vti_bin"), "true", "false")
| eval large_upload=if(bytes_out > 50000, "true", "false")
| bucket _time span=1h
| stats 
    count as connections,
    sum(bytes_out) as total_out,
    sum(bytes_in) as total_in,
    sum(eval(if(method="POST", 1, 0))) as post_requests,
    sum(eval(if(sharepoint_traffic="true", 1, 0))) as sharepoint_connections,
    sum(eval(if(business_hours="true", 1, 0))) as business_hour_activity,
    sum(eval(if(large_upload="true", 1, 0))) as large_uploads,
    dc(src_ip) as unique_sources,
    dc(hour) as active_hours
    by src_ip
| eval 
    data_ratio=if(total_out>0, total_in/total_out, 0),
    exfil_risk=case(
        total_out > 10000000 AND sharepoint_connections > 0, "critical_sharepoint_breach",
        total_out > 1000000 AND post_requests > 20, "high_data_exfiltration",
        total_out > 100000 AND large_uploads > 5, "medium_suspicious_transfer",
        1=1, "low"),
    persistence_score=case(
        active_hours > 16 AND business_hour_activity > 50, "high_persistent_access",
        active_hours > 10, "medium_regular_access", 
        1=1, "low"),
    eagle_threat_score=case(
        exfil_risk="critical_sharepoint_breach", 98,
        exfil_risk="high_data_exfiltration" AND persistence_score="high_persistent_access", 85,
        exfil_risk="medium_suspicious_transfer" AND sharepoint_connections > 0, 70,
        sharepoint_connections > 0, 60,
        1=1, 45)
| where eagle_threat_score >= 50
| sort -eagle_threat_score
| table src_ip, connections, total_out, sharepoint_connections, exfil_risk, persistence_score, eagle_threat_score`,

                sigma: `title: APT-C-36 Blind Eagle IP Communication Analysis
id: bf2g6h3d-7e8f-5g9h-0i1j-1e5g7h9i1k3l
description: Detects suspicious communication patterns with APT-C-36 infrastructure
status: experimental
author: Elite Eagle Hunter
date: 2025/08/14
logsource:
    category: network_connection
    product: windows
detection:
    selection:
        destination.ip: '{{IOC}}'
    sharepoint_exploitation:
        - destination.url|contains: '_vti_bin'
        - http.request.method: 'POST'
    data_exfiltration:
        - network.bytes: '>100000'
        - connection_count: '>20'
    persistence_check:
        timespan: 24h
        unique_hours: '>10'
    condition: selection AND (sharepoint_exploitation OR data_exfiltration OR persistence_check)
fields:
    - source.ip
    - destination.ip
    - destination.url
    - network.bytes
    - http.request.method
falsepositives:
    - Legitimate SharePoint administration
    - Large file transfers to cloud services
level: high
tags:
    - attack.exfiltration
    - attack.t1041
    - attack.initial_access
    - attack.t1190
    - attack.command_and_control
    - attack.t1071.001`,

                suricata: `alert tcp any any -> {{IOC}} any (
    msg:"APT-C-36 Blind Eagle Infrastructure Communication"; 
    content:"_vti_bin"; http_uri;
    content:"POST"; http_method;
    threshold:type both, track by_src, count 5, seconds 600;
    byte_test:4,>,100000,0,relative;
    reference:url,apt-c-36-analysis;
    classtype:trojan-activity; 
    sid:3600002; 
    rev:2;
    metadata:campaign apt-c-36, technique sharepoint-exploit;
)`
            },
            hash: {
                kql: `// APT-C-36 Blind Eagle Hash Analysis with Campaign Reconstruction
// Correlates malware execution with SharePoint exploitation and financial targeting
let timeframe = 60d;
let target_hash = "{{IOC}}";

// File execution analysis for Eagle malware
let file_execution = 
    DeviceFileEvents
    | where Timestamp > ago(timeframe)
    | where SHA256 == target_hash or MD5 == target_hash or SHA1 == target_hash
    | extend 
        FileExtension = tolower(extract(@"\\.([^.]+)$", 1, FileName)),
        IsWebShell = iff(FileName has_any("shell.aspx", ".aspx") and FolderPath has "inetpub", true, false),
        IsEagleRansomware = iff(FileName endswith ".eagle" or FileName == "RECOVERY_INSTRUCTIONS.html", true, false),
        IsControlVault = iff(FileName =~ "msimg32.dll" and FolderPath has "ControlVault", true, false)
    | join kind=inner (
        DeviceProcessEvents
        | where Timestamp > ago(timeframe)
        | where ProcessCommandLine != ""
    ) on DeviceName, $left.Timestamp == $right.Timestamp
    | project Timestamp, DeviceName, FileName, FolderPath, ProcessCommandLine, AccountName, 
              FileExtension, IsWebShell, IsEagleRansomware, IsControlVault;

// SharePoint exploitation correlation
let sharepoint_activity = 
    DeviceNetworkEvents
    | where Timestamp > ago(timeframe)
    | where RemoteUrl contains "_vti_bin"
    | join kind=inner file_execution on DeviceName
    | where abs(datetime_diff('minute', Timestamp, Timestamp1)) < 60
    | summarize 
        SharePointExploits = count(),
        ExploitDomains = make_set(RemoteUrl),
        FirstExploit = min(Timestamp),
        LastExploit = max(Timestamp)
        by DeviceName, FileName;

// ControlVault persistence detection
let persistence_check = 
    DeviceRegistryEvents
    | where Timestamp > ago(timeframe)
    | where RegistryKey has_any("ControlVault", "Dell", "Broadcom")
    | where RegistryValueName has_any("ServiceDll", "ImagePath", "Start")
    | join kind=inner file_execution on DeviceName
    | where abs(datetime_diff('minute', Timestamp, Timestamp1)) < 120
    | project DeviceName, RegistryKey, RegistryValueName, RegistryValueData, ControlVaultPersistence = true;

// Campaign reconstruction with Eagle-specific staging
file_execution
| join kind=leftouter sharepoint_activity on DeviceName, FileName
| join kind=leftouter persistence_check on DeviceName
| extend 
    EagleCampaignStage = case(
        IsEagleRansomware and SharePointExploits > 0 and ControlVaultPersistence == true, "Full_Eagle_Deployment",
        IsWebShell and SharePointExploits > 0, "SharePoint_Web_Shell_Stage", 
        IsControlVault and ControlVaultPersistence == true, "Firmware_Persistence_Stage",
        SharePointExploits > 0, "Initial_SharePoint_Exploit",
        isnotempty(ProcessCommandLine), "Malware_Execution",
        "File_Dropped"),
    EagleThreatScore = case(
        EagleCampaignStage == "Full_Eagle_Deployment", 98,
        EagleCampaignStage == "SharePoint_Web_Shell_Stage", 88,
        EagleCampaignStage == "Firmware_Persistence_Stage", 85,
        EagleCampaignStage == "Initial_SharePoint_Exploit", 75,
        EagleCampaignStage == "Malware_Execution", 65,
        50)
| where EagleThreatScore >= 65
| sort by EagleThreatScore desc, Timestamp desc`,

                splunk: `// APT-C-36 Hash Campaign Reconstruction with Financial Focus
(index=endpoint_logs (file_hash="{{IOC}}" OR md5="{{IOC}}" OR sha256="{{IOC}}")) OR 
(index=process_logs process_hash="{{IOC}}")
| eval event_category=case(
    match(index, "endpoint"), "file_event",
    match(index, "process"), "process_event",
    1=1, "other")
| transaction host maxspan=60m startswith=eval(event_category="file_event")
| eval 
    is_webshell=if(match(file_name, "(?i)shell\\.aspx|\\.aspx") AND match(file_path, "(?i)inetpub"), "true", "false"),
    is_eagle_ransomware=if(match(file_name, "(?i)\\.eagle|recovery_instructions"), "true", "false"),
    is_controlvault=if(match(file_name, "(?i)msimg32\\.dll") AND match(file_path, "(?i)controlvault"), "true", "false"),
    execution_context=if(isnotnull(process_name), "executed", "dropped"),
    eagle_campaign_stage=case(
        is_eagle_ransomware="true" AND isnotnull(sharepoint_activity) AND isnotnull(controlvault_persistence), "full_eagle_deployment",
        is_webshell="true" AND isnotnull(sharepoint_activity), "sharepoint_webshell_stage",
        is_controlvault="true" AND isnotnull(controlvault_persistence), "firmware_persistence_stage",
        isnotnull(sharepoint_activity), "initial_sharepoint_exploit",
        execution_context="executed", "malware_execution",
        1=1, "file_dropped"),
    eagle_threat_score=case(
        eagle_campaign_stage="full_eagle_deployment", 98,
        eagle_campaign_stage="sharepoint_webshell_stage", 88,
        eagle_campaign_stage="firmware_persistence_stage", 85,
        eagle_campaign_stage="initial_sharepoint_exploit", 75,
        eagle_campaign_stage="malware_execution", 65,
        1=1, 50)
| where eagle_threat_score >= 65
| stats 
    values(file_name) as files,
    values(process_name) as processes,
    max(eagle_threat_score) as max_score,
    values(eagle_campaign_stage) as stages,
    count as events
    by host
| sort -max_score`,

                yara: `rule APT_C36_BlindEagle_Hash_{{RANDOM}} {
    meta:
        author = "Elite Eagle Hunter"
        description = "APT-C-36 Blind Eagle Malware Family Detection"
        reference = "Financial Sector Campaign Analysis"
        date = "2025-08-14"
        hash = "{{IOC}}"
        campaign = "APT-C-36 Blind Eagle"
        confidence = "high"
        
    condition:
        hash.sha256(0, filesize) == "{{IOC}}" or
        hash.md5(0, filesize) == "{{IOC}}" or  
        hash.sha1(0, filesize) == "{{IOC}}"
        
    meta:
        // Eagle-specific campaign context
        related_campaigns = "Check for other Blind Eagle variants"
        execution_context = "Monitor for SharePoint exploitation and web shell deployment"
        persistence_indicators = "Check ControlVault registry modifications"
        financial_targeting = "Monitor banking and financial institution access"
}`,

                sigma: `title: APT-C-36 Blind Eagle Malware Hash Execution
id: ch3i7j4e-8f9g-5h0i-1j2k-2g5i7j9k2m4n
description: Detects execution of known APT-C-36 Blind Eagle malware samples
status: experimental
author: Elite Eagle Hunter
date: 2025/08/14
logsource:
    category: file_event
    product: windows
detection:
    selection:
        - file.hash.sha256: '{{IOC}}'
        - file.hash.md5: '{{IOC}}'
        - file.hash.sha1: '{{IOC}}'
    eagle_context:
        - file.path|contains: 'inetpub'
        - file.path|contains: 'ControlVault'
        - file.name|endswith: '.aspx'
        - file.name|endswith: '.eagle'
    execution_context:
        - event.type: 'process_start'
        - event.type: 'file_creation'
        - parent_process.name: 'w3wp.exe'
    condition: selection AND (eagle_context OR execution_context)
fields:
    - file.name
    - file.path
    - process.command_line
    - parent_process.name
    - user.name
falsepositives:
    - Unlikely for known APT-C-36 malware hashes
level: critical
tags:
    - attack.execution
    - attack.t1059
    - attack.initial_access
    - attack.t1190
    - attack.persistence
    - attack.t1542`
            },
            filename: {
                kql: `// APT-C-36 Blind Eagle Filename Analysis with SharePoint Context
// Monitors Eagle-specific file patterns and execution contexts
let timeframe = 30d;
let target_filename = "{{IOC}}";

// File creation and execution analysis for Eagle patterns
let file_analysis = 
    DeviceFileEvents
    | where Timestamp > ago(timeframe)
    | where FileName =~ target_filename
    | extend 
        FileLocation = case(
            FolderPath has_any("inetpub", "wwwroot"), "Web_Server_Directory",
            FolderPath has_any("ControlVault", "Dell"), "ControlVault_Directory",
            FolderPath has_any("temp", "tmp"), "Temp_Directory",
            FolderPath has "appdata", "User_Profile",
            FolderPath has_any("system32", "syswow64"), "System_Directory",
            "Other"),
        SuspiciousLocation = iff(FileLocation in ("Web_Server_Directory", "ControlVault_Directory", "Temp_Directory"), true, false),
        IsWebShell = iff(FileName has_any("shell.aspx", ".aspx") and FileLocation == "Web_Server_Directory", true, false),
        IsEagleRansomware = iff(FileName has_any(".eagle", "RECOVERY_INSTRUCTIONS"), true, false),
        IsControlVaultFile = iff(FileName =~ "msimg32.dll" and FileLocation == "ControlVault_Directory", true, false);

// Process execution correlation for Eagle campaign
let execution_context = 
    DeviceProcessEvents
    | where Timestamp > ago(timeframe)
    | where ProcessCommandLine contains target_filename or FileName =~ target_filename
    | join kind=inner file_analysis on DeviceName
    | where abs(datetime_diff('minute', Timestamp, Timestamp1)) < 30
    | extend 
        ExecutionMethod = case(
            InitiatingProcessFileName =~ "w3wp.exe", "Web_Server_Execution",
            InitiatingProcessFileName =~ "powershell.exe", "PowerShell_Execution",
            InitiatingProcessFileName =~ "cmd.exe", "CMD_Execution", 
            InitiatingProcessFileName =~ "rundll32.exe", "DLL_Execution",
            "Direct_Execution");

// SharePoint exploitation correlation
let sharepoint_correlation = 
    DeviceNetworkEvents
    | where Timestamp > ago(timeframe)
    | where RemoteUrl contains "_vti_bin"
    | join kind=inner file_analysis on DeviceName
    | where abs(datetime_diff('hour', Timestamp, Timestamp1)) < 2
    | extend SharePointExploitation = true;

// Eagle threat scoring based on context
execution_context
| join kind=leftouter sharepoint_correlation on DeviceName, FileName
| extend 
    LocationScore = iff(SuspiciousLocation, 25, 0),
    ExecutionScore = case(
        ExecutionMethod == "Web_Server_Execution", 40,
        ExecutionMethod == "PowerShell_Execution", 30,
        ExecutionMethod == "DLL_Execution", 25,
        10),
    EagleSpecificScore = case(
        IsWebShell and SharePointExploitation == true, 45,
        IsEagleRansomware, 50,
        IsControlVaultFile, 40,
        0),
    TotalEagleScore = LocationScore + ExecutionScore + EagleSpecificScore,
    EagleThreatClassification = case(
        TotalEagleScore >= 80, "Critical_Eagle_Activity",
        TotalEagleScore >= 60, "High_Eagle_Threat",
        TotalEagleScore >= 40, "Medium_Eagle_Suspicion",
        "Low_Risk")
| where EagleThreatClassification != "Low_Risk"
| project Timestamp, DeviceName, FileName, FolderPath, ProcessCommandLine, 
          ExecutionMethod, FileLocation, IsWebShell, IsEagleRansomware, IsControlVaultFile,
          TotalEagleScore, EagleThreatClassification, SharePointExploitation
| sort by TotalEagleScore desc`,

                splunk: `// APT-C-36 
